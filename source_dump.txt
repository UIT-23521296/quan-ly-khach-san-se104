# ==================================================
# Path: E:\Dai Hoc\Nam 3\Nhap mon CNPM\quan-ly-khach-san-se104
# Detected tech: docker, javascript, python, react, typescript
# ==================================================

## DIRECTORY STRUCTURE
```
quan-ly-khach-san-se104/
‚îú‚îÄ‚îÄ .git/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ db.js
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loaikhachController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ phieuthueController.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ phongController.js
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authMiddleware.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ roleMiddleware.js
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loaikhachModel.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ phieuthueModel.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ phongModel.js
‚îÇ   ‚îú‚îÄ‚îÄ node_modules/
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authRoutes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loaikhachRoutes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loaiphongRoutes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ phieuthueRoutes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ phongRoutes.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ thamSoRoutes.js
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.js
‚îÇ   ‚îú‚îÄ‚îÄ .env
‚îÇ   ‚îú‚îÄ‚îÄ createAdmin.js
‚îÇ   ‚îú‚îÄ‚îÄ package-lock.json
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ server.js
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ node_modules/
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vite.svg
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ react.svg
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Navbar.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Sidebar.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BookingManagement.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Login.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ RoomManagement.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.jsx
‚îÇ   ‚îú‚îÄ‚îÄ .gitignore
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ eslint.config.js
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ package-lock.json
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.js
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ quanlykhachsan.sql
‚îî‚îÄ‚îÄ source_dump.txt
```

## FILE CONTENTS

### backend\createAdmin.js
```js
// createAdmin.js
const bcrypt = require("bcryptjs");
const db = require("./config/db");

(async () => {
  const username = "admin";
  const password = "admin123";
  const hoTen = "Qu·∫£n Tr·ªã H·ªá Th·ªëng";
  const vaiTro = "Admin";

  const hashedPassword = await bcrypt.hash(password, 10);

  db.query(
    "INSERT INTO Users (Username, Password, HoTen, VaiTro) VALUES (?, ?, ?, ?)",
    [username, hashedPassword, hoTen, vaiTro],
    (err, result) => {
      if (err) {
        console.error("‚ùå L·ªói t·∫°o admin:", err);
        process.exit();
      }

      console.log("‚úÖ T·∫°o t√†i kho·∫£n admin th√†nh c√¥ng!");
      process.exit();
    }
  );
})();

```

### backend\server.js
```js
// backend/server.js
require("dotenv").config(); // ƒê·ªçc file .env

const express = require("express");
const cors = require("cors");

const app = express();
const PORT = process.env.PORT || 9999;

// Middleware
app.use(cors());
app.use(express.json());

// K·∫øt n·ªëi DB
require("./config/db");

// ==== ROUTES ====
const authRoutes = require("./routes/authRoutes");
const phongRoutes = require("./routes/phongRoutes");
const thamSoRoutes = require("./routes/thamSoRoutes");
const loaiphongRoutes = require("./routes/loaiphongRoutes");
const phieuthueRoutes = require("./routes/phieuthueRoutes");
const loaikhachRoutes = require("./routes/loaikhachRoutes");

// ==== S·ª¨ D·ª§NG ROUTES ====
app.use("/api/auth", authRoutes);
app.use("/api/phong", phongRoutes);
app.use("/api/thamso", thamSoRoutes);
app.use("/api/loaiphong", loaiphongRoutes);
app.use("/api/phieuthue", phieuthueRoutes);
app.use("/api/loaikhach", loaikhachRoutes);
// Test API
app.get("/api/test", (req, res) => {
  res.json({ message: "Backend ƒëang ch·∫°y!" });
});

// Start server
app.listen(PORT, () => {
  console.log(`üöÄ Server ch·∫°y t·∫°i http://localhost:${PORT}`);
});

```

### backend\config\db.js
```js
const mysql = require("mysql2");

const pool = mysql.createPool({
  host: process.env.DB_HOST || "localhost",
  user: process.env.DB_USER || "root",
  password: process.env.DB_PASS || "",
  database: process.env.DB_NAME || "quanlykhachsan",
  waitForConnections: true,
  connectionLimit: 10,
  queueLimit: 0,
});

pool.getConnection((err, conn) => {
  if (err) {
    console.error("‚ùå L·ªói k·∫øt n·ªëi MySQL:", err);
  } else {
    console.log("‚úÖ K·∫øt n·ªëi MySQL th√†nh c√¥ng!");
    conn.release();
  }
});

module.exports = pool;

```

### backend\controllers\loaikhachController.js
```js
const loaikhachModel = require("../models/loaikhachModel");

exports.getAllLoaiKhach = async (req, res) => {
  try {
    const [rows] = await loaikhachModel.getAll();
    res.json(rows);
  } catch (err) {
    console.error("‚ùå L·ªói l·∫•y lo·∫°i kh√°ch:", err);
    res.status(500).json({ message: "Kh√¥ng l·∫•y ƒë∆∞·ª£c lo·∫°i kh√°ch" });
  }
};

```

### backend\controllers\phieuthueController.js
```js
const phieuThueModel = require("../models/phieuthueModel");
const db = require("../config/db");
const { v4: uuidv4 } = require("uuid");

// =======================
// T·∫†O PHI·∫æU THU√ä PH√íNG
// =======================
exports.createPhieuThue = async (req, res) => {
  const { MaPhong, NgayBatDauThue, NgayDuKienTra, danhSachKhach } = req.body;

  /* =======================
     1Ô∏è‚É£ VALIDATE C∆† B·∫¢N
  ======================= */
  if (!MaPhong || !NgayBatDauThue || !NgayDuKienTra) {
    return res.status(400).json({
      message: "Thi·∫øu th√¥ng tin phi·∫øu thu√™",
    });
  }

  if (!Array.isArray(danhSachKhach) || danhSachKhach.length === 0) {
    return res.status(400).json({
      message: "Ch∆∞a c√≥ kh√°ch h√†ng",
    });
  }

  for (const k of danhSachKhach) {
    if (!k.HoTen || !k.MaLoaiKhach || !k.CMND) {
      return res.status(400).json({
        message: "Thi·∫øu th√¥ng tin kh√°ch b·∫Øt bu·ªôc",
      });
    }
  }

  /* =======================
     2Ô∏è‚É£ CHECK NG√ÄY THU√ä
  ======================= */
  const startDate = new Date(NgayBatDauThue);
  const endDate = new Date(NgayDuKienTra);

  if (isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {
    return res.status(400).json({
      message: "Ng√†y thu√™ kh√¥ng h·ª£p l·ªá",
    });
  }

  if (startDate >= endDate) {
    return res.status(400).json({
      message: "Ng√†y d·ª± ki·∫øn tr·∫£ ph·∫£i sau ng√†y b·∫Øt ƒë·∫ßu thu√™",
    });
  }

  /* =======================
     3Ô∏è‚É£ TRANSACTION
  ======================= */
  const conn = await db.promise().getConnection();

  try {
    await conn.beginTransaction();

    const SoPhieu = "PT" + Date.now();

    // üëâ Th√™m phi·∫øu thu√™
    await conn.query(
      `
      INSERT INTO phieuthue
      (SoPhieu, MaPhong, NgayBatDauThue, NgayDuKienTra)
      VALUES (?, ?, ?, ?)
    `,
      [SoPhieu, MaPhong, NgayBatDauThue, NgayDuKienTra]
    );

    // üëâ Th√™m t·ª´ng kh√°ch + g·∫Øn v√†o phi·∫øu thu√™
    for (const k of danhSachKhach) {
      const MaKH = uuidv4();

      await conn.query(
        `
        INSERT INTO khachhang
        (MaKH, HoTen, MaLoaiKhach, CMND, DiaChi, SDT)
        VALUES (?, ?, ?, ?, ?, ?)
      `,
        [MaKH, k.HoTen, k.MaLoaiKhach, k.CMND, k.DiaChi, k.SDT]
      );

      await conn.query(
        `
        INSERT INTO ct_phieuthue
        (SoPhieu, MaKH)
        VALUES (?, ?)
      `,
        [SoPhieu, MaKH]
      );
    }

    // üëâ Update tr·∫°ng th√°i ph√≤ng
    await conn.query(
      `UPDATE phong SET TinhTrang = 'ƒê√£ thu√™' WHERE MaPhong = ?`,
      [MaPhong]
    );

    await conn.commit();

    res.json({
      message: "L·∫≠p phi·∫øu thu√™ ph√≤ng th√†nh c√¥ng",
      SoPhieu,
    });
  } catch (error) {
    await conn.rollback();
    console.error("‚ùå L·ªói t·∫°o phi·∫øu thu√™:", error);
    res.status(500).json({
      message: "L·ªói server khi t·∫°o phi·∫øu thu√™",
    });
  } finally {
    conn.release();
  }
};

// =======================
// L·∫§Y DANH S√ÅCH PHI·∫æU THU√ä
// =======================
exports.getAllPhieuThue = async (req, res) => {
  try {
    const [rows] = await phieuThueModel.getAll();
    res.json(rows);
  } catch (error) {
    console.error(error);
    res.status(500).json({
      message: "Kh√¥ng l·∫•y ƒë∆∞·ª£c danh s√°ch phi·∫øu thu√™",
    });
  }
};

// =======================
// 3Ô∏è‚É£ X·ª¨ L√ù H·ª¶Y PHI·∫æU
// =======================
exports.huyPhieu = async (req, res) => {
  const { soPhieu } = req.params;
  const conn = await db.promise().getConnection();
  
  try {
    await conn.beginTransaction();

    // 1. C·∫≠p nh·∫≠t tr·∫°ng th√°i phi·∫øu -> ƒê√£ h·ªßy
    await conn.query(
      "UPDATE phieuthue SET TrangThaiLuuTru = 'DA_HUY' WHERE SoPhieu = ?",
      [soPhieu]
    );

    // 2. L·∫•y m√£ ph√≤ng c·ªßa phi·∫øu n√†y ƒë·ªÉ tr·∫£ l·∫°i tr·∫°ng th√°i 'Tr·ªëng' cho ph√≤ng
    const [rows] = await conn.query("SELECT MaPhong FROM phieuthue WHERE SoPhieu = ?", [soPhieu]);
    if (rows.length > 0) {
      const maPhong = rows[0].MaPhong;
      await conn.query("UPDATE phong SET TinhTrang = 'Tr·ªëng' WHERE MaPhong = ?", [maPhong]);
    }

    await conn.commit();
    res.json({ message: "ƒê√£ h·ªßy phi·∫øu th√†nh c√¥ng" });
  } catch (error) {
    await conn.rollback();
    console.error(error);
    res.status(500).json({ message: "L·ªói khi h·ªßy phi·∫øu" });
  } finally {
    conn.release();
  }
};

// =======================
// 4Ô∏è‚É£ X·ª¨ L√ù THANH TO√ÅN (CHECK-OUT)
// =======================
exports.thanhToan = async (req, res) => {
  const { soPhieu } = req.params;
  const conn = await db.promise().getConnection();

  try {
    await conn.beginTransaction();

    // 1. C·∫≠p nh·∫≠t tr·∫°ng th√°i thanh to√°n v√† tr·∫°ng th√°i l∆∞u tr√∫
    await conn.query(
      `UPDATE phieuthue 
       SET TrangThaiThanhToan = 'DA_THANH_TOAN', 
           TrangThaiLuuTru = 'DA_TRA_PHONG' 
       WHERE SoPhieu = ?`,
      [soPhieu]
    );

    // 2. Tr·∫£ ph√≤ng v·ªÅ tr·∫°ng th√°i 'Tr·ªëng' (ƒë·ªÉ kh√°ch kh√°c thu√™ ƒë∆∞·ª£c) -> Ho·∫∑c 'ƒêang d·ªçn' t√πy quy tr√¨nh
    const [rows] = await conn.query("SELECT MaPhong FROM phieuthue WHERE SoPhieu = ?", [soPhieu]);
    if (rows.length > 0) {
      const maPhong = rows[0].MaPhong;
      await conn.query("UPDATE phong SET TinhTrang = 'ƒêang d·ªçn' WHERE MaPhong = ?", [maPhong]);
    }

    await conn.commit();
    res.json({ message: "Thanh to√°n v√† tr·∫£ ph√≤ng th√†nh c√¥ng!" });
  } catch (error) {
    await conn.rollback();
    console.error(error);
    res.status(500).json({ message: "L·ªói khi thanh to√°n" });
  } finally {
    conn.release();
  }
};

// =======================
// 5Ô∏è‚É£ X·ª¨ L√ù CHECK-IN
// =======================
exports.checkIn = async (req, res) => {
  const { soPhieu } = req.params;
  const conn = await db.promise().getConnection();

  try {
    // C·∫≠p nh·∫≠t tr·∫°ng th√°i sang ƒêANG THU√ä
    await conn.query(
      "UPDATE phieuthue SET TrangThaiLuuTru = 'DANG_THUE' WHERE SoPhieu = ?",
      [soPhieu]
    );
    res.json({ message: "Check-in th√†nh c√¥ng! Kh√°ch ƒë√£ nh·∫≠n ph√≤ng." });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "L·ªói khi check-in" });
  } finally {
    conn.release();
  }
};
```

### backend\controllers\phongController.js
```js
const phongModel = require("../models/phongModel");

exports.getAllRooms = async (req, res) => {
  try {
    const [rows] = await phongModel.getAll();
    res.json(rows);
  } catch (err) {
    res.status(500).json({ error: err });
  }
};

exports.createRoom = async (req, res) => {
  const { TenPhong, MaLoaiPhong, TinhTrang, GhiChu } = req.body;

  // validate t√™n ph√≤ng
  const soPhong = TenPhong?.match(/\d+/);
  if (!soPhong) {
    return res.status(400).json({
      message: "T√™n ph√≤ng ph·∫£i c√≥ s·ªë (VD: Ph√≤ng 101)",
    });
  }

  const MaPhong = "P" + soPhong[0];

  try {
    // üîç CHECK TR√ôNG
    const [exist] = await phongModel.findByMaPhong(MaPhong);
    if (exist.length > 0) {
      return res.status(400).json({
        message: `Ph√≤ng ${MaPhong} ƒë√£ t·ªìn t·∫°i`,
      });
    }

    // ‚úÖ INSERT
    await phongModel.create([
      MaPhong,
      TenPhong,
      MaLoaiPhong,
      TinhTrang,
      GhiChu,
    ]);

    res.json({
      message: "Th√™m ph√≤ng th√†nh c√¥ng",
      MaPhong,
    });
  } catch (err) {
    console.error("‚ùå SQL ERROR CODE:", err.code);
    console.error("‚ùå SQL MESSAGE:", err.sqlMessage);

    return res.status(500).json({
      message: err.sqlMessage || "Kh√¥ng th·ªÉ l∆∞u ph√≤ng",
    });
  }
};

// ‚úÖ TH√äM M·ªöI
exports.updateRoom = async (req, res) => {
  const { id } = req.params;
  const { MaPhong, TenPhong, MaLoaiPhong, TinhTrang, GhiChu } = req.body;

  try {
    await phongModel.update([TenPhong, MaLoaiPhong, TinhTrang, GhiChu, id]);
    res.json({ message: "C·∫≠p nh·∫≠t ph√≤ng th√†nh c√¥ng" });
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
};

// ‚úÖ TH√äM M·ªöI
exports.deleteRoom = async (req, res) => {
  const { id } = req.params;

  try {
    await phongModel.delete(id);
    res.json({ message: "X√≥a ph√≤ng th√†nh c√¥ng" });
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
};

```

### backend\middleware\authMiddleware.js
```js
const jwt = require("jsonwebtoken");
require("dotenv").config();

module.exports = (req, res, next) => {
  const header = req.headers.authorization;
  if (!header) {
    return res.status(401).json({ error: "Thi·∫øu token" });
  }

  const token = header.split(" ")[1];

  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded; // l∆∞u user v√†o req ƒë·ªÉ d√πng sau
    next();
  } catch (err) {
    return res.status(401).json({ error: "Token kh√¥ng h·ª£p l·ªá" });
  }
};

```

### backend\middleware\roleMiddleware.js
```js
module.exports = (...allowedRoles) => {
  return (req, res, next) => {
    if (!allowedRoles.includes(req.user.vaiTro)) {
      return res.status(403).json({ error: "Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p" });
    }
    next();
  };
};

```

### backend\models\loaikhachModel.js
```js
// const db = require("../config/db");

// exports.getAll = () => {
//   const sql = `
//     SELECT MaLoaiKhach, TenLoaiKhach, HeSoPhuThu
//     FROM loaikhach
//   `;
//   return db.promise().query(sql);
// };
const db = require("../config/db");

exports.getAll = () => {
  const sql = "SELECT * FROM loaikhach";
  return db.promise().query(sql);
};

```

### backend\models\phieuthueModel.js
```js
const db = require("../config/db");

/* =========================
   PHI·∫æU THU√ä PH√íNG MODEL
   ========================= */

// 1Ô∏è‚É£ Th√™m kh√°ch h√†ng
exports.insertKhachHang = (data) => {
  const sql = `
    INSERT INTO khachhang 
    (MaKH, HoTen, MaLoaiKhach, CMND, DiaChi, SDT)
    VALUES (?, ?, ?, ?, ?, ?)
  `;
  return db.promise().query(sql, data);
};

// 2Ô∏è‚É£ Th√™m phi·∫øu thu√™
exports.insertPhieuThue = (data) => {
  const sql = `
    INSERT INTO phieuthue
    (SoPhieu, MaPhong, NgayBatDauThue, NgayDuKienTra)
    VALUES (?, ?, ?, ?)
  `;
  return db.promise().query(sql, data);
};

// 3Ô∏è‚É£ G·∫Øn kh√°ch v√†o phi·∫øu thu√™
exports.insertCTPhieuThue = (data) => {
  const sql = `
    INSERT INTO ct_phieuthue
    (SoPhieu, MaKH)
    VALUES (?, ?)
  `;
  return db.promise().query(sql, data);
};

// 4Ô∏è‚É£ C·∫≠p nh·∫≠t tr·∫°ng th√°i ph√≤ng
exports.updateTinhTrangPhong = (data) => {
  const sql = `
    UPDATE phong
    SET TinhTrang = ?
    WHERE MaPhong = ?
  `;
  return db.promise().query(sql, data);
};

// 5Ô∏è‚É£ L·∫•y danh s√°ch phi·∫øu thu√™
exports.getAll = () => {
  const sql = `
    SELECT 
      pt.SoPhieu,
      pt.MaPhong,
      p.TenPhong,
      pt.NgayBatDauThue,
      pt.NgayDuKienTra,
      pt.TrangThaiLuuTru,
      COALESCE(hd.TrangThaiThanhToan, 'CHUA_THANH_TOAN') AS TrangThaiThanhToan,
      kh.HoTen,
      lk.TenLoaiKhach,
      kh.CMND,
      kh.SDT
    FROM phieuthue pt
    JOIN phong p ON pt.MaPhong = p.MaPhong
    JOIN ct_phieuthue ct ON pt.SoPhieu = ct.SoPhieu
    JOIN khachhang kh ON ct.MaKH = kh.MaKH
    JOIN loaikhach lk ON kh.MaLoaiKhach = lk.MaLoaiKhach
    
    -- üëá D√πng LEFT JOIN ƒë·ªÉ kh√¥ng b·ªã m·∫•t kh√°ch ƒëang ·ªü (ch∆∞a c√≥ h√≥a ƒë∆°n)
    LEFT JOIN hoadon hd ON pt.SoPhieu = hd.SoPhieu 
    
    ORDER BY pt.NgayBatDauThue DESC
  `;
  return db.promise().query(sql);
};
```

### backend\models\phongModel.js
```js
const db = require("../config/db");

exports.getAll = () => {
  const sql = `
    SELECT p.*, lp.TenLoaiPhong, lp.DonGia
    FROM PHONG p
    JOIN LOAIPHONG lp ON p.MaLoaiPhong = lp.MaLoaiPhong
  `;
  return db.promise().query(sql);
};

exports.create = (data) => {
  const sql = `
    INSERT INTO PHONG (MaPhong, TenPhong, MaLoaiPhong, TinhTrang, GhiChu)
    VALUES (?, ?, ?, ?, ?)
  `;
  return db.promise().query(sql, data);
};

exports.update = (data) => {
  const sql = `
    UPDATE PHONG
    SET TenPhong = ?, MaLoaiPhong = ?, TinhTrang = ?, GhiChu = ?
    WHERE MaPhong = ?
  `;
  return db.promise().query(sql, data);
};
exports.findByMaPhong = (MaPhong) => {
  const sql = `SELECT 1 FROM PHONG WHERE MaPhong = ? LIMIT 1`;
  return db.promise().query(sql, [MaPhong]);
};

exports.delete = (id) => {
  const sql = `DELETE FROM PHONG WHERE MaPhong = ?`;
  return db.promise().query(sql, [id]);
};

```

### backend\models\User.js
```js
const db = require("../config/db");

const User = {
  // T√¨m user theo username
  findByUsername: (username, callback) => {
    const sql = "SELECT * FROM Users WHERE Username = ?";
    db.query(sql, [username], callback);
  },

  // T·∫°o user m·ªõi (Admin t·∫°o t√†i kho·∫£n)
  create: (userData, callback) => {
    const sql =
      "INSERT INTO Users (Username, Password, HoTen, VaiTro) VALUES (?, ?, ?, ?)";

    db.query(
      sql,
      [userData.username, userData.password, userData.hoTen, userData.vaiTro],
      callback
    );
  },

  // L·∫•y danh s√°ch user
  getAll: (callback) => {
    const sql = "SELECT MaNV, Username, HoTen, VaiTro, NgayTao FROM Users";
    db.query(sql, callback);
  },
};

module.exports = User;

```

### backend\routes\authRoutes.js
```js
const express = require("express");
const bcrypt = require("bcrypt");
const jwt = require("jsonwebtoken");
const User = require("../models/User");

const router = express.Router();

// ƒêƒÇNG NH·∫¨P
router.post("/login", (req, res) => {
  const { username, password } = req.body;

  User.findByUsername(username, async (err, results) => {
    if (err) return res.status(500).json({ error: "L·ªói server" });
    if (results.length === 0)
      return res.status(401).json({ error: "T√†i kho·∫£n kh√¥ng t·ªìn t·∫°i" });

    const user = results[0];

    // So s√°nh m·∫≠t kh·∫©u ƒë√£ hash
    const match = await bcrypt.compare(password, user.Password);
    if (!match) return res.status(401).json({ error: "Sai m·∫≠t kh·∫©u" });

    // T·∫°o token
    const token = jwt.sign(
      {
        id: user.MaNV,
        username: user.Username,
        vaiTro: user.VaiTro,
      },
      process.env.JWT_SECRET,
      { expiresIn: "8h" }
    );

    return res.json({
      message: "ƒêƒÉng nh·∫≠p th√†nh c√¥ng",
      token,
      user: {
        id: user.MaNV,
        username: user.Username,
        hoTen: user.HoTen,
        vaiTro: user.VaiTro,
      },
    });
  });
});

// Admin t·∫°o user m·ªõi
router.post("/create", async (req, res) => {
  const { username, password, hoTen, vaiTro } = req.body;

  const hashed = await bcrypt.hash(password, Number(process.env.SALT_ROUNDS));

  User.create({ username, password: hashed, hoTen, vaiTro }, (err, result) => {
    if (err) return res.status(500).json({ error: err });
    res.json({ message: "T·∫°o user th√†nh c√¥ng" });
  });
});

module.exports = router;

```

### backend\routes\loaikhachRoutes.js
```js
const express = require("express");
const router = express.Router();
const loaikhachController = require("../controllers/loaikhachController");

router.get("/", loaikhachController.getAllLoaiKhach);

module.exports = router;

```

### backend\routes\loaiphongRoutes.js
```js
const express = require("express");
const router = express.Router();
const db = require("../config/db");

// GET t·∫•t c·∫£ lo·∫°i ph√≤ng
router.get("/", async (req, res) => {
  try {
    const [rows] = await db
      .promise()
      .query("SELECT MaLoaiPhong, TenLoaiPhong, DonGia FROM loaiphong");

    res.json(rows);
  } catch (err) {
    console.error("‚ùå L·ªói l·∫•y lo·∫°i ph√≤ng:", err);
    res.status(500).json({ message: "L·ªói server" });
  }
});

module.exports = router;

```

### backend\routes\phieuthueRoutes.js
```js
const express = require("express");
const router = express.Router();
const phieuThueController = require("../controllers/phieuthueController");

// T·∫°o phi·∫øu thu√™ ph√≤ng
router.post("/", phieuThueController.createPhieuThue);

// (tu·ª≥ ch·ªçn) l·∫•y danh s√°ch phi·∫øu thu√™
router.get("/", phieuThueController.getAllPhieuThue);

// C√°c route kh√°c (h·ªßy phi·∫øu, thanh to√°n)
router.put("/:soPhieu/huy", phieuThueController.huyPhieu);
router.put("/:soPhieu/thanhtoan", phieuThueController.thanhToan);

// Check-in kh√°ch
router.put("/:soPhieu/checkin", phieuThueController.checkIn);

module.exports = router;

```

### backend\routes\phongRoutes.js
```js
const express = require("express");
const router = express.Router();
const phongController = require("../controllers/phongController");

// L·∫•y danh s√°ch ph√≤ng
router.get("/", phongController.getAllRooms);

// Th√™m ph√≤ng
router.post("/", phongController.createRoom);

// C·∫≠p nh·∫≠t ph√≤ng
router.put("/:id", phongController.updateRoom);

// X√≥a ph√≤ng
router.delete("/:id", phongController.deleteRoom);

module.exports = router;

```

### backend\routes\thamSoRoutes.js
```js
const express = require("express");
const router = express.Router();
const db = require("../config/db");

// L·∫•y s·ªë kh√°ch t·ªëi ƒëa
router.get("/sokhachMax", (req, res) => {
  const sql = "SELECT SoKhachToiDa FROM thamso LIMIT 1";
  db.query(sql, (err, result) => {
    if (err) return res.status(500).json({ message: "L·ªói DB" });

    res.json({ soKhachToiDa: result[0].SoKhachToiDa });
  });
});

module.exports = router;

```

### backend\services\api.js
```js
import axios from "axios";

const api = axios.create({
  baseURL: "http://localhost:9999/api",
});

api.interceptors.request.use((config) => {
  const token = localStorage.getItem("token");
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

export default api;

```

### frontend\eslint.config.js
```js
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{js,jsx}'],
    extends: [
      js.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
      parserOptions: {
        ecmaVersion: 'latest',
        ecmaFeatures: { jsx: true },
        sourceType: 'module',
      },
    },
    rules: {
      'no-unused-vars': ['error', { varsIgnorePattern: '^[A-Z_]' }],
    },
  },
])

```

### frontend\vite.config.js
```js
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
})

```

### frontend\src\App.jsx
```jsx
// src/App.jsx
import {
  BrowserRouter as Router,
  Routes,
  Route,
  Navigate,
} from "react-router-dom";
import Login from "./pages/Login";
import Dashboard from "./pages/Dashboard";
import RoomManagement from "./pages/RoomManagement";
import Navbar from "./components/Navbar";
import Sidebar from "./components/Sidebar";
import { useState } from "react";
import BookingManagement from "./pages/BookingManagement";

function PrivateLayout({ children }) {
  const token = localStorage.getItem("token");

  if (!token) return <Navigate to="/login" replace />;

  return (
    <div style={styles.app}>
      <Navbar />
      <div style={styles.main}>
        <SidebarWrapper />
        <div style={styles.content}>{children}</div>
      </div>
    </div>
  );
}

function SidebarWrapper() {
  const [activeMenu, setActiveMenu] = useState("dashboard");
  return <Sidebar activeMenu={activeMenu} setActiveMenu={setActiveMenu} />;
}

function App() {
  return (
    <Router>
      <Routes>
        {/* PUBLIC */}
        <Route path="/login" element={<Login />} />

        {/* PRIVATE ROUTES */}
        <Route
          path="/"
          element={
            <PrivateLayout>
              <Dashboard />
            </PrivateLayout>
          }
        />

        <Route
          path="/rooms"
          element={
            <PrivateLayout>
              <RoomManagement />
            </PrivateLayout>
          }
        />

        {/* C√°c trang c√≤n l·∫°i b·∫°n s·∫Ω th√™m sau */}
        <Route
          path="/phieuthue"
          element={
            <PrivateLayout>
              <BookingManagement />
            </PrivateLayout>
          }
        />
      </Routes>
    </Router>
  );
}

const styles = {
  app: {
    display: "flex",
    flexDirection: "column",
    height: "100vh",
  },
  main: {
    display: "flex",
    flex: 1,
    overflow: "hidden",
  },
  content: {
    flex: 1,
    padding: "1rem",
    backgroundColor: "#F5F8FF",
    overflow: "auto",
  },
};

export default App;

```

### frontend\src\main.jsx
```jsx
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.jsx'

createRoot(document.getElementById('root')).render(
  <StrictMode>
    <App />
  </StrictMode>,
)

```

### frontend\src\components\Navbar.jsx
```jsx
import React from "react";

const Navbar = () => {
  // L·∫•y th√¥ng tin user t·ª´ localStorage
  const user = JSON.parse(localStorage.getItem("user") || "{}");

  // Map vai tr√≤ sang ti·∫øng Vi·ªát
  const roleDisplay = {
    Admin: "Qu·∫£n tr·ªã vi√™n",
    QuanLy: "Qu·∫£n l√Ω",
    LeTan: "L·ªÖ t√¢n",
    BanGiamDoc: "Ban gi√°m ƒë·ªëc",
  };

  return (
    <nav style={styles.navbar}>
      <h2 style={styles.title}>üè® Qu·∫£n L√Ω Kh√°ch S·∫°n</h2>

      <div style={styles.userInfo}>
        <span style={styles.userName}>üë§ {user.hoTen || "User"}</span>
        <span style={styles.role}>
          {roleDisplay[user.vaiTro] || user.vaiTro}
        </span>
        <button
          style={styles.logoutBtn}
          onClick={() => {
            if (window.confirm("B·∫°n c√≥ ch·∫Øc mu·ªën ƒëƒÉng xu·∫•t?")) {
              localStorage.clear();
              window.location.href = "/login";
            }
          }}
        >
          ƒêƒÉng xu·∫•t
        </button>
      </div>
    </nav>
  );
};

const styles = {
  navbar: {
    display: "flex",
    justifyContent: "space-between",
    alignItems: "center",
    padding: "1rem 2rem",
    backgroundColor: "#1F2A40",
    color: "white",
  },
  title: {
    margin: 0,
    fontSize: "1.5rem",
  },
  userInfo: {
    display: "flex",
    alignItems: "center",
    gap: "1rem",
  },
  userName: {
    fontWeight: 600,
    fontSize: "0.95rem",
  },
  role: {
    padding: "0.3rem 0.8rem",
    backgroundColor: "rgba(255,255,255,0.2)",
    borderRadius: "6px",
    fontSize: "0.85rem",
  },
  logoutBtn: {
    padding: "0.5rem 1rem",
    backgroundColor: "#FF6B6B",
    color: "white",
    border: "none",
    borderRadius: "6px",
    cursor: "pointer",
    fontWeight: 600,
  },
};

export default Navbar;

```

### frontend\src\components\Sidebar.jsx
```jsx
// src/components/Sidebar.jsx
import React from "react";
import { useNavigate } from "react-router-dom";

const Sidebar = ({ activeMenu, setActiveMenu }) => {
  const navigate = useNavigate();

  const menuItems = [
    { id: "dashboard", icon: "üìä", label: "T·ªïng quan", path: "/" },
    { id: "rooms", icon: "üõèÔ∏è", label: "Danh m·ª•c ph√≤ng", path: "/rooms" },
    { id: "booking", icon: "üìù", label: "Thu√™ ph√≤ng", path: "/phieuthue" },
    { id: "invoice", icon: "üíµ", label: "H√≥a ƒë∆°n", path: "/invoice" },
    { id: "report", icon: "üìà", label: "B√°o c√°o doanh thu", path: "/report" },
    { id: "settings", icon: "‚öôÔ∏è", label: "Qui ƒë·ªãnh", path: "/settings" },
  ];

  return (
    <div style={styles.sidebar}>
      {menuItems.map((item) => (
        <div
          key={item.id}
          style={{
            ...styles.menuItem,
            backgroundColor: activeMenu === item.id ? "#3A7DFF" : "transparent",
          }}
          onClick={() => {
            setActiveMenu(item.id);
            navigate(item.path); // üëâ ƒëi·ªÅu h∆∞·ªõng route
          }}
        >
          <span style={styles.icon}>{item.icon}</span>
          <span>{item.label}</span>
        </div>
      ))}
    </div>
  );
};

const styles = {
  sidebar: {
    width: "250px",
    backgroundColor: "#1F2A40",
    color: "white",
    minHeight: "100vh",
    padding: "1rem 0",
  },
  menuItem: {
    display: "flex",
    alignItems: "center",
    padding: "1rem 1.5rem",
    cursor: "pointer",
    borderRadius: "8px",
    margin: "0.3rem 0.5rem",
    transition: "0.3s",
  },
  icon: {
    marginRight: "1rem",
    fontSize: "1.2rem",
  },
};

export default Sidebar;

```

### frontend\src\pages\BookingManagement.jsx
```jsx
import React, { useEffect, useState } from "react";
import api from "../services/api";

/* =====================
   STATE M·∫™U
===================== */
const emptyForm = {
  MaPhong: "",
  NgayBatDauThue: "",
  NgayDuKienTra: "",
};

const emptyKhach = {
  HoTen: "",
  MaLoaiKhach: "",
  CMND: "",
  DiaChi: "",
  SDT: "",
};

const BookingManagement = () => {
  const [bookings, setBookings] = useState([]);
  const [rooms, setRooms] = useState([]);
  const [guestTypes, setGuestTypes] = useState([]);

  const [form, setForm] = useState(emptyForm);
  const [khachList, setKhachList] = useState([{ ...emptyKhach }]);
  const [soKhachToiDa, setSoKhachToiDa] = useState(1);

  const [isModalOpen, setIsModalOpen] = useState(false);
  const [loading, setLoading] = useState(false);

  /* =====================
     LOAD DATA
  ===================== */
  useEffect(() => {
    fetchBookings();
    fetchRooms();
    fetchGuestTypes();
    fetchSoKhachMax();
  }, []);

  const fetchBookings = async () => {
    const res = await api.get("/phieuthue");
    setBookings(res.data);
  };

  const fetchRooms = async () => {
    const res = await api.get("/phong");
    setRooms(res.data.filter((r) => r.TinhTrang === "Tr·ªëng"));
  };

  const fetchGuestTypes = async () => {
    const res = await api.get("/loaikhach");
    setGuestTypes(res.data);
  };

  const fetchSoKhachMax = async () => {
    const res = await api.get("/thamso/sokhachMax");
    setSoKhachToiDa(res.data.soKhachToiDa);
  };

  /* =====================
     HANDLER
  ===================== */
  const openModal = () => {
    setForm(emptyForm);
    setKhachList([{ ...emptyKhach }]);
    setIsModalOpen(true);
  };

  const closeModal = () => setIsModalOpen(false);

  const handleFormChange = (e) =>
    setForm({ ...form, [e.target.name]: e.target.value });

  const handleKhachChange = (index, field, value) => {
    const newList = [...khachList];
    newList[index][field] = value;
    setKhachList(newList);
  };

  const addKhach = () => {
    if (khachList.length >= soKhachToiDa) return;
    setKhachList([...khachList, { ...emptyKhach }]);
  };

  const removeKhach = (index) => {
    if (khachList.length === 1) return;
    setKhachList(khachList.filter((_, i) => i !== index));
  };

  const handleSubmit = async () => {
    if (khachList.length > soKhachToiDa) {
      alert("‚ùå V∆∞·ª£t qu√° s·ªë kh√°ch t·ªëi ƒëa");
      return;
    }

    setLoading(true);
    try {
      await api.post("/phieuthue", {
        ...form,
        danhSachKhach: khachList,
      });
      alert("‚úÖ L·∫≠p phi·∫øu thu√™ th√†nh c√¥ng");
      closeModal();
      fetchBookings();
      fetchRooms();
    } catch (err) {
      alert("‚ùå " + (err.response?.data?.message || "L·ªói t·∫°o phi·∫øu"));
    } finally {
      setLoading(false);
    }
  };

  /* =====================
     FORMAT DATE
  ===================== */
  const formatDate = (dateStr) => {
    if (!dateStr) return "";
    const date = new Date(dateStr);
    const day = String(date.getDate()).padStart(2, "0");
    const month = String(date.getMonth() + 1).padStart(2, "0");
    const year = date.getFullYear();
    return `${day}/${month}/${year}`;
  };

  const getTrangThai = (booking) => {
    // // N·∫øu c√≥ tr·∫°ng th√°i t·ª´ API th√¨ d√πng, kh√¥ng th√¨ t·ª± t√≠nh
    // if (booking.TrangThai) {
    //   return booking.TrangThai;
    // }

    // const today = new Date();
    // today.setHours(0, 0, 0, 0);

    // const ngayBatDau = new Date(booking.NgayBatDauThue);
    // ngayBatDau.setHours(0, 0, 0, 0);

    // const ngayTra = new Date(booking.NgayDuKienTra);
    // ngayTra.setHours(0, 0, 0, 0);

    // if (today < ngayBatDau) {
    //   return "CHUA_CHECKIN";
    // } else if (today >= ngayBatDau && today <= ngayTra) {
    //   return "DANG_THUE";
    // } else {
    //   return "DA_TRA";
    // }

    if (booking.TrangThaiThanhToan === 'DA_THANH_TOAN') {
       return 'DA_THANH_TOAN';
    }

    // ∆Øu ti√™n l·∫•y tr·∫°ng th√°i t·ª´ DB
    if (booking.TrangThaiLuuTru) {
      return booking.TrangThaiLuuTru; 
    }
    // Fallback (d·ª± ph√≤ng n·∫øu d·ªØ li·ªáu c≈© ch∆∞a c√≥ c·ªôt n√†y)
    return "CHUA_CHECKIN";
  };

  const renderTrangThai = (trangThai) => {
    const statusMap = {
      // CHUA_CHECKIN: { icon: "üü°", text: "Ch∆∞a check-in", color: "#f59e0b" },
      // DANG_THUE: { icon: "üü¢", text: "ƒêang thu√™", color: "#10b981" },
      // DA_TRA: { icon: "üîµ", text: "ƒê√£ tr·∫£ ph√≤ng", color: "#3b82f6" },
      // DA_THANH_TOAN: { icon: "‚úÖ", text: "ƒê√£ thanh to√°n", color: "#8b5cf6" },
      // DA_HUY: { icon: "üî¥", text: "ƒê√£ h·ªßy", color: "#ef4444" },
      CHUA_CHECKIN: { icon: "üü°", text: "Ch∆∞a check-in", color: "#f59e0b" },
      DANG_THUE: { icon: "üü¢", text: "ƒêang thu√™", color: "#10b981" },
      DA_TRA_PHONG: { icon: "‚úÖ", text: "ƒê√£ tr·∫£ ph√≤ng", color: "#3b82f6" }, 
      DA_HUY: { icon: "üî¥", text: "ƒê√£ h·ªßy", color: "#ef4444" },
      DA_THANH_TOAN: { icon: "üí∞", text: "ƒê√£ thanh to√°n", color: "#8b5cf6" },
    };

    const status = statusMap[trangThai] || statusMap.DANG_THUE;

    return (
      <span
        style={{
          ...styles.statusBadge,
          background: `${status.color}20`,
          color: status.color,
          border: `1px solid ${status.color}40`,
        }}
      >
        {status.icon} {status.text}
      </span>
    );
  };

  /* =====================
     ACTIONS HANDLER
  ===================== */
  const handleViewDetail = (booking) => {
    alert(`Xem chi ti·∫øt phi·∫øu: ${booking.SoPhieu}`);
    // TODO: M·ªü modal hi·ªÉn th·ªã chi ti·∫øt
  };

  const handleEdit = (booking) => {
    const trangThai = getTrangThai(booking);
    if (trangThai === "DA_THANH_TOAN") {
      alert("‚ùå Kh√¥ng th·ªÉ s·ª≠a phi·∫øu ƒë√£ thanh to√°n");
      return;
    }
    alert(`S·ª≠a phi·∫øu: ${booking.SoPhieu}`);
    // TODO: M·ªü modal ch·ªânh s·ª≠a
  };

  const handleDelete = async (booking) => {
    const trangThai = getTrangThai(booking);
    if (trangThai === "DA_THANH_TOAN") {
      alert("‚ùå Kh√¥ng th·ªÉ x√≥a phi·∫øu ƒë√£ thanh to√°n");
      return;
    }

    if (!window.confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a phi·∫øu ${booking.SoPhieu}?`)) {
      return;
    }

    try {
      await api.delete(`/phieuthue/${booking.SoPhieu}`);
      alert("‚úÖ X√≥a phi·∫øu th√†nh c√¥ng");
      fetchBookings();
      fetchRooms();
    } catch (err) {
      alert("‚ùå " + (err.response?.data?.message || "L·ªói x√≥a phi·∫øu"));
    }
  };

  // const handleCancel = async (booking) => {
  //   const trangThai = getTrangThai(booking);
  //   if (trangThai === "DA_THANH_TOAN") {
  //     alert("‚ùå Kh√¥ng th·ªÉ h·ªßy phi·∫øu ƒë√£ thanh to√°n");
  //     return;
  //   }

  //   if (trangThai === "DA_HUY") {
  //     alert("‚ÑπÔ∏è Phi·∫øu n√†y ƒë√£ ƒë∆∞·ª£c h·ªßy tr∆∞·ªõc ƒë√≥");
  //     return;
  //   }

  //   if (
  //     !window.confirm(
  //       `B·∫°n c√≥ ch·∫Øc mu·ªën H·ª¶Y phi·∫øu ${booking.SoPhieu}?\n\nPhi·∫øu s·∫Ω kh√¥ng b·ªã x√≥a nh∆∞ng s·∫Ω ƒë√°nh d·∫•u l√† "ƒê√£ h·ªßy" ƒë·ªÉ l∆∞u l·ªãch s·ª≠.`
  //     )
  //   ) {
  //     return;
  //   }

  //   try {
  //     await api.put(`/phieuthue/${booking.SoPhieu}/huy`);
  //     alert("‚úÖ H·ªßy phi·∫øu th√†nh c√¥ng");
  //     fetchBookings();
  //     fetchRooms();
  //   } catch (err) {
  //     alert("‚ùå " + (err.response?.data?.message || "L·ªói h·ªßy phi·∫øu"));
  //   }
  // };

    const handleCancel = async (booking) => {
      if (booking.TrangThaiThanhToan === 'DA_THANH_TOAN') {
        alert("‚ùå Kh√°ch ƒë√£ thanh to√°n, kh√¥ng th·ªÉ h·ªßy!");
        return;
      }
      
      if (!window.confirm(`B·∫°n ch·∫Øc ch·∫Øn mu·ªën H·ª¶Y phi·∫øu ${booking.SoPhieu}?`)) return;

      try {
        // G·ªçi API H·ªßy
        await api.put(`/phieuthue/${booking.SoPhieu}/huy`);
        alert("‚úÖ ƒê√£ h·ªßy phi·∫øu th√†nh c√¥ng");
        fetchBookings(); // T·∫£i l·∫°i danh s√°ch
        fetchRooms();    // C·∫≠p nh·∫≠t l·∫°i tr·∫°ng th√°i ph√≤ng
      } catch (err) {
        alert("‚ùå L·ªói: " + (err.response?.data?.message || "Kh√¥ng th·ªÉ h·ªßy"));
      }
  };

  // const handlePayment = (booking) => {
  //   const trangThai = getTrangThai(booking);
  //   if (trangThai === "DA_THANH_TOAN") {
  //     alert("‚úÖ Phi·∫øu n√†y ƒë√£ ƒë∆∞·ª£c thanh to√°n");
  //     return;
  //   }
  //   alert(`Thanh to√°n phi·∫øu: ${booking.SoPhieu}`);
  //   // TODO: Chuy·ªÉn ƒë·∫øn trang thanh to√°n/t·∫°o h√≥a ƒë∆°n
  // };
    const handlePayment = async (booking) => {
      if (booking.TrangThaiThanhToan === 'DA_THANH_TOAN') {
        alert("‚úÖ Phi·∫øu n√†y ƒë√£ thanh to√°n r·ªìi!");
        return;
      }

      if (!window.confirm(`X√°c nh·∫≠n thanh to√°n v√† tr·∫£ ph√≤ng cho phi·∫øu ${booking.SoPhieu}?`)) return;

      try {
        // G·ªçi API Thanh to√°n
        await api.put(`/phieuthue/${booking.SoPhieu}/thanhtoan`);
        alert("‚úÖ Thanh to√°n th√†nh c√¥ng!");
        fetchBookings();
        fetchRooms();
      } catch (err) {
        alert("‚ùå L·ªói: " + (err.response?.data?.message || "Thanh to√°n th·∫•t b·∫°i"));
      }
  };

  const handleCheckIn = async (booking) => {
    if (!window.confirm(`X√°c nh·∫≠n kh√°ch ƒë√£ ƒë·∫øn v√† nh·∫≠n ph√≤ng ${booking.TenPhong}?`)) return;

    try {
      await api.put(`/phieuthue/${booking.SoPhieu}/checkin`);
      alert("‚úÖ Check-in th√†nh c√¥ng!");
      fetchBookings(); // Load l·∫°i b·∫£ng ƒë·ªÉ th·∫•y m√†u xanh l√°
    } catch (err) {
      alert("‚ùå L·ªói: " + (err.response?.data?.message || "Kh√¥ng th·ªÉ check-in"));
    }
  };

  /* =====================
     RENDER
  ===================== */
  return (
    <div style={styles.wrapper}>
      <div style={styles.container}>
        <div style={styles.header}>
          <div>
            <h1 style={styles.title}>üìã Qu·∫£n l√Ω phi·∫øu thu√™ ph√≤ng</h1>
            <p style={styles.subtitle}>
              Qu·∫£n l√Ω v√† theo d√µi c√°c phi·∫øu thu√™ ph√≤ng kh√°ch s·∫°n
            </p>
          </div>
          <button style={styles.addBtn} onClick={openModal}>
            <span style={styles.btnIcon}>+</span>
            <span>T·∫°o phi·∫øu thu√™ m·ªõi</span>
          </button>
        </div>

        {/* TABLE */}
        <div style={styles.tableContainer}>
          <table style={styles.table}>
            <thead>
              <tr style={styles.tableHeader}>
                <th style={styles.th}>S·ªë phi·∫øu</th>
                <th style={styles.th}>Ph√≤ng</th>
                <th style={styles.th}>Kh√°ch h√†ng</th>
                <th style={styles.th}>Ng√†y thu√™</th>
                <th style={styles.th}>Ng√†y tr·∫£ d·ª± ki·∫øn</th>
                <th style={styles.th}>Tr·∫°ng th√°i</th>
                <th style={styles.th}>Thao t√°c</th>
              </tr>
            </thead>
            <tbody>
              {Object.values(
                bookings.reduce((acc, b) => {
                  if (!acc[b.SoPhieu]) {
                    acc[b.SoPhieu] = { ...b, khachList: [b.HoTen] };
                  } else {
                    acc[b.SoPhieu].khachList.push(b.HoTen);
                  }
                  return acc;
                }, {})
              ).map((b, idx) => {
                const trangThai = getTrangThai(b);
                const isDisabled = trangThai === "DA_THANH_TOAN";

                return (
                  <tr
                    key={b.SoPhieu}
                    style={{
                      ...styles.tableRow,
                      background: idx % 2 === 0 ? "#f8fafc" : "#ffffff",
                    }}
                  >
                    <td style={styles.td}>
                      <span style={styles.badge}>{b.SoPhieu}</span>
                    </td>
                    <td style={styles.td}>
                      <strong style={styles.roomName}>{b.TenPhong}</strong>
                    </td>
                    <td style={styles.td}>
                      <div>
                        {b.khachList.map((khach, i) => (
                          <div key={i} style={{ marginBottom: 4 }}>
                            {khach}
                          </div>
                        ))}
                        <span
                          style={{
                            color: "#94a3b8",
                            fontSize: 12,
                            fontWeight: 600,
                            marginTop: 4,
                            display: "block",
                          }}
                        >
                          ({b.khachList.length} kh√°ch)
                        </span>
                      </div>
                    </td>
                    <td style={styles.td}>
                      <span style={styles.date}>
                        {formatDate(b.NgayBatDauThue)}
                      </span>
                    </td>
                    <td style={styles.td}>
                      <span style={styles.date}>
                        {formatDate(b.NgayDuKienTra)}
                      </span>
                    </td>
                    <td style={styles.td}>{renderTrangThai(trangThai)}</td>
                    <td style={styles.tdActions}>
                      <div style={styles.actionButtons}>
                        <button
                          style={styles.actionBtn}
                          onClick={() => handleViewDetail(b)}
                          title="Xem chi ti·∫øt"
                        >
                          üëÅÔ∏è
                        </button>
                        {/* N√öT CHECK-IN (Ch·ªâ hi·ªán khi ch∆∞a check-in) */}
                        {trangThai === "CHUA_CHECKIN" && (
                          <button
                            style={{
                              ...styles.actionBtn,
                              background: "#e0f2fe", // M√†u xanh d∆∞∆°ng nh·∫°t
                              color: "#0284c7"
                            }}
                            onClick={() => handleCheckIn(b)}
                            title="Check-in nh·∫≠n ph√≤ng"
                          >
                            üõéÔ∏è
                          </button>
                        )}
                        <button
                          style={{
                            ...styles.actionBtn,
                            ...(isDisabled ? styles.actionBtnDisabled : {}),
                          }}
                          onClick={() => handleEdit(b)}
                          disabled={isDisabled}
                          title="S·ª≠a"
                        >
                          ‚úèÔ∏è
                        </button>
                        <button
                          style={{
                            ...styles.actionBtn,
                            background: "#fee2e2",
                            ...(isDisabled ? styles.actionBtnDisabled : {}),
                          }}
                          onClick={() => handleCancel(b)}
                          disabled={isDisabled}
                          title="H·ªßy phi·∫øu"
                        >
                          ‚ùå
                        </button>
                        <button
                          style={{
                            ...styles.actionBtn,
                            background: "#fef3c7",
                            ...(isDisabled ? styles.actionBtnDisabled : {}),
                          }}
                          onClick={() => handleDelete(b)}
                          disabled={isDisabled}
                          title="X√≥a"
                        >
                          üóëÔ∏è
                        </button>
                        <button
                          style={{
                            ...styles.actionBtn,
                            background:
                              trangThai === "DA_THANH_TOAN"
                                ? "#e0e7ff"
                                : "#dcfce7",
                          }}
                          onClick={() => handlePayment(b)}
                          title="Thanh to√°n"
                        >
                          üí∞
                        </button>
                      </div>
                    </td>
                  </tr>
                );
              })}
            </tbody>
          </table>
        </div>

        {/* MODAL */}
        {isModalOpen && (
          <div style={styles.overlay} onClick={closeModal}>
            <div style={styles.modal} onClick={(e) => e.stopPropagation()}>
              <div style={styles.modalHeader}>
                <h2 style={styles.modalTitle}>‚ú® T·∫°o phi·∫øu thu√™ ph√≤ng m·ªõi</h2>
                <button style={styles.closeBtn} onClick={closeModal}>
                  ‚úï
                </button>
              </div>

              <div style={styles.form}>
                <div style={styles.formGroup}>
                  <label style={styles.label}>Ph√≤ng</label>
                  <select
                    name="MaPhong"
                    onChange={handleFormChange}
                    style={styles.select}
                  >
                    <option value="">-- Ch·ªçn ph√≤ng tr·ªëng --</option>
                    {rooms.map((r) => (
                      <option key={r.MaPhong} value={r.MaPhong}>
                        üö™ {r.TenPhong}
                      </option>
                    ))}
                  </select>
                </div>

                <div style={styles.dateGroup}>
                  <div style={styles.formGroup}>
                    <label style={styles.label}>Ng√†y b·∫Øt ƒë·∫ßu thu√™</label>
                    <input
                      type="date"
                      name="NgayBatDauThue"
                      onChange={handleFormChange}
                      style={styles.input}
                    />
                  </div>
                  <div style={styles.formGroup}>
                    <label style={styles.label}>Ng√†y tr·∫£ d·ª± ki·∫øn</label>
                    <input
                      type="date"
                      name="NgayDuKienTra"
                      onChange={handleFormChange}
                      style={styles.input}
                    />
                  </div>
                </div>

                <div style={styles.guestSection}>
                  <div style={styles.guestHeader}>
                    <h4 style={styles.guestTitle}>üë• Danh s√°ch kh√°ch</h4>
                    <span style={styles.guestLimit}>
                      {khachList.length} / {soKhachToiDa} kh√°ch
                    </span>
                  </div>

                  {khachList.map((k, index) => (
                    <div key={index} style={styles.khachBox}>
                      <div style={styles.khachHeader}>
                        <span style={styles.khachNumber}>
                          Kh√°ch #{index + 1}
                        </span>
                        {khachList.length > 1 && (
                          <button
                            style={styles.removeBtn}
                            onClick={() => removeKhach(index)}
                          >
                            üóëÔ∏è X√≥a
                          </button>
                        )}
                      </div>

                      <div style={styles.khachGrid}>
                        <div style={styles.formGroup}>
                          <label style={styles.labelSmall}>H·ªç t√™n *</label>
                          <input
                            placeholder="Nh·∫≠p h·ªç t√™n"
                            value={k.HoTen}
                            onChange={(e) =>
                              handleKhachChange(index, "HoTen", e.target.value)
                            }
                            style={styles.input}
                          />
                        </div>

                        <div style={styles.formGroup}>
                          <label style={styles.labelSmall}>Lo·∫°i kh√°ch *</label>
                          <select
                            value={k.MaLoaiKhach}
                            onChange={(e) =>
                              handleKhachChange(
                                index,
                                "MaLoaiKhach",
                                e.target.value
                              )
                            }
                            style={styles.select}
                          >
                            <option value="">-- Ch·ªçn lo·∫°i --</option>
                            {guestTypes.map((g) => (
                              <option key={g.MaLoaiKhach} value={g.MaLoaiKhach}>
                                {g.TenLoaiKhach}
                              </option>
                            ))}
                          </select>
                        </div>

                        <div style={styles.formGroup}>
                          <label style={styles.labelSmall}>CCCD/CMND *</label>
                          <input
                            placeholder="S·ªë CCCD"
                            value={k.CMND}
                            onChange={(e) =>
                              handleKhachChange(index, "CMND", e.target.value)
                            }
                            style={styles.input}
                          />
                        </div>

                        <div style={styles.formGroup}>
                          <label style={styles.labelSmall}>ƒê·ªãa ch·ªâ</label>
                          <input
                            placeholder="ƒê·ªãa ch·ªâ li√™n h·ªá"
                            value={k.DiaChi}
                            onChange={(e) =>
                              handleKhachChange(index, "DiaChi", e.target.value)
                            }
                            style={styles.input}
                          />
                        </div>

                        <div style={styles.formGroup}>
                          <label style={styles.labelSmall}>S·ªë ƒëi·ªán tho·∫°i</label>
                          <input
                            placeholder="S·ªë ƒëi·ªán tho·∫°i"
                            value={k.SDT}
                            onChange={(e) =>
                              handleKhachChange(index, "SDT", e.target.value)
                            }
                            style={styles.input}
                          />
                        </div>
                      </div>
                    </div>
                  ))}

                  <button
                    onClick={addKhach}
                    disabled={khachList.length >= soKhachToiDa}
                    style={{
                      ...styles.addGuestBtn,
                      ...(khachList.length >= soKhachToiDa
                        ? styles.addGuestBtnDisabled
                        : {}),
                    }}
                  >
                    ‚ûï Th√™m kh√°ch h√†ng
                  </button>
                </div>
              </div>

              <div style={styles.actions}>
                <button style={styles.cancelBtn} onClick={closeModal}>
                  H·ªßy b·ªè
                </button>
                <button
                  style={styles.submitBtn}
                  onClick={handleSubmit}
                  disabled={loading}
                >
                  {loading ? "‚è≥ ƒêang l∆∞u..." : "üíæ L∆∞u phi·∫øu thu√™"}
                </button>
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

/* =====================
   STYLE - SOFT NEUTRAL THEME
===================== */
const styles = {
  wrapper: {
    minHeight: "100vh",
    background: "linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%)",
    padding: "32px 16px",
  },
  container: {
    maxWidth: 1200,
    margin: "0 auto",
  },
  header: {
    display: "flex",
    justifyContent: "space-between",
    alignItems: "center",
    marginBottom: 32,
    background: "rgba(255,255,255,0.95)",
    padding: 24,
    borderRadius: 16,
    boxShadow: "0 4px 20px rgba(0,0,0,0.08)",
  },
  title: {
    margin: 0,
    fontSize: 32,
    fontWeight: 700,
    color: "#2d3748",
  },
  subtitle: {
    margin: "8px 0 0 0",
    color: "#64748b",
    fontSize: 14,
  },
  addBtn: {
    display: "flex",
    alignItems: "center",
    gap: 8,
    padding: "12px 24px",
    background: "#4299e1",
    color: "#fff",
    border: "none",
    borderRadius: 10,
    fontSize: 15,
    fontWeight: 600,
    cursor: "pointer",
    boxShadow: "0 4px 12px rgba(66, 153, 225, 0.3)",
    transition: "all 0.3s ease",
  },
  btnIcon: {
    fontSize: 20,
    fontWeight: 700,
  },
  tableContainer: {
    background: "#fff",
    borderRadius: 16,
    overflow: "hidden",
    boxShadow: "0 4px 20px rgba(0,0,0,0.08)",
  },
  table: {
    width: "100%",
    borderCollapse: "collapse",
  },
  tableHeader: {
    background: "#718096",
  },
  th: {
    padding: "16px 20px",
    textAlign: "left",
    color: "#fff",
    fontWeight: 600,
    fontSize: 14,
    textTransform: "uppercase",
    letterSpacing: "0.5px",
  },
  tableRow: {
    transition: "all 0.2s ease",
    cursor: "pointer",
  },
  td: {
    padding: "16px 20px",
    fontSize: 14,
    color: "#334155",
    borderBottom: "1px solid #e2e8f0",
  },
  badge: {
    background: "#4a5568",
    color: "#fff",
    padding: "4px 12px",
    borderRadius: 20,
    fontSize: 13,
    fontWeight: 600,
  },
  roomName: {
    color: "#2d3748",
    fontWeight: 600,
  },
  date: {
    color: "#64748b",
    fontSize: 13,
  },
  statusBadge: {
    padding: "6px 12px",
    borderRadius: 20,
    fontSize: 12,
    fontWeight: 600,
    display: "inline-block",
    whiteSpace: "nowrap",
  },
  tdActions: {
    padding: "16px 20px",
    fontSize: 14,
    color: "#334155",
    borderBottom: "1px solid #e2e8f0",
  },
  actionButtons: {
    display: "flex",
    gap: 6,
    justifyContent: "center",
    flexWrap: "wrap",
  },
  actionBtn: {
    background: "#f1f5f9",
    border: "1px solid #e2e8f0",
    borderRadius: 8,
    padding: "6px 10px",
    fontSize: 16,
    cursor: "pointer",
    transition: "all 0.2s ease",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  },
  actionBtnDisabled: {
    opacity: 0.4,
    cursor: "not-allowed",
  },
  overlay: {
    position: "fixed",
    inset: 0,
    background: "rgba(0,0,0,.6)",
    backdropFilter: "blur(4px)",
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
    zIndex: 1000,
  },
  modal: {
    background: "#fff",
    borderRadius: 20,
    width: "90%",
    maxWidth: 700,
    maxHeight: "90vh",
    overflowY: "auto",
    boxShadow: "0 20px 60px rgba(0,0,0,0.3)",
  },
  modalHeader: {
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
    padding: "24px 28px",
    borderBottom: "2px solid #e2e8f0",
    background: "#f7fafc",
    position: "relative",
  },
  modalTitle: {
    margin: 0,
    fontSize: 24,
    fontWeight: 700,
    color: "#2d3748",
  },
  closeBtn: {
    position: "absolute",
    right: "28px",
    background: "transparent",
    border: "none",
    fontSize: 24,
    color: "#64748b",
    cursor: "pointer",
    width: 32,
    height: 32,
    borderRadius: "50%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
    transition: "all 0.2s ease",
  },
  form: {
    padding: "28px",
  },
  formGroup: {
    marginBottom: 20,
  },
  label: {
    display: "block",
    marginBottom: 8,
    fontSize: 14,
    fontWeight: 600,
    color: "#1e293b",
  },
  labelSmall: {
    display: "block",
    marginBottom: 6,
    fontSize: 13,
    fontWeight: 600,
    color: "#475569",
  },
  input: {
    width: "100%",
    padding: "12px 16px",
    border: "2px solid #e2e8f0",
    borderRadius: 10,
    fontSize: 14,
    transition: "all 0.2s ease",
    outline: "none",
    boxSizing: "border-box",
  },
  select: {
    width: "100%",
    padding: "12px 16px",
    border: "2px solid #e2e8f0",
    borderRadius: 10,
    fontSize: 14,
    transition: "all 0.2s ease",
    outline: "none",
    background: "#fff",
    cursor: "pointer",
    boxSizing: "border-box",
  },
  dateGroup: {
    display: "grid",
    gridTemplateColumns: "1fr 1fr",
    gap: 16,
  },
  guestSection: {
    marginTop: 24,
    padding: 20,
    background: "#f8fafc",
    borderRadius: 12,
  },
  guestHeader: {
    display: "flex",
    justifyContent: "space-between",
    alignItems: "center",
    marginBottom: 16,
  },
  guestTitle: {
    margin: 0,
    fontSize: 18,
    fontWeight: 700,
    color: "#1e293b",
  },
  guestLimit: {
    background: "#4a5568",
    color: "#fff",
    padding: "4px 12px",
    borderRadius: 20,
    fontSize: 12,
    fontWeight: 600,
  },
  khachBox: {
    background: "#fff",
    border: "2px solid #e2e8f0",
    padding: 20,
    borderRadius: 12,
    marginBottom: 16,
    boxShadow: "0 2px 8px rgba(0,0,0,0.05)",
  },
  khachHeader: {
    display: "flex",
    justifyContent: "space-between",
    alignItems: "center",
    marginBottom: 16,
    paddingBottom: 12,
    borderBottom: "2px solid #e2e8f0",
  },
  khachNumber: {
    fontSize: 14,
    fontWeight: 700,
    color: "#4a5568",
  },
  removeBtn: {
    background: "#e53e3e",
    color: "#fff",
    border: "none",
    padding: "6px 12px",
    borderRadius: 8,
    fontSize: 12,
    fontWeight: 600,
    cursor: "pointer",
    transition: "all 0.2s ease",
  },
  khachGrid: {
    display: "grid",
    gridTemplateColumns: "1fr 1fr",
    gap: 12,
  },
  addGuestBtn: {
    width: "100%",
    padding: "12px",
    background: "#48bb78",
    color: "#fff",
    border: "none",
    borderRadius: 10,
    fontSize: 14,
    fontWeight: 600,
    cursor: "pointer",
    transition: "all 0.2s ease",
  },
  addGuestBtnDisabled: {
    background: "#cbd5e1",
    cursor: "not-allowed",
    opacity: 0.6,
  },
  actions: {
    display: "flex",
    justifyContent: "flex-end",
    gap: 12,
    padding: "24px 28px",
    borderTop: "2px solid #e2e8f0",
    background: "#f8fafc",
  },
  cancelBtn: {
    padding: "12px 24px",
    background: "#fff",
    color: "#64748b",
    border: "2px solid #e2e8f0",
    borderRadius: 10,
    fontSize: 14,
    fontWeight: 600,
    cursor: "pointer",
    transition: "all 0.2s ease",
  },
  submitBtn: {
    padding: "12px 24px",
    background: "#4299e1",
    color: "#fff",
    border: "none",
    borderRadius: 10,
    fontSize: 14,
    fontWeight: 600,
    cursor: "pointer",
    boxShadow: "0 4px 12px rgba(66, 153, 225, 0.3)",
    transition: "all 0.2s ease",
  },
};

export default BookingManagement;

```

### frontend\src\pages\Dashboard.jsx
```jsx
import React, { useState } from "react";

const Dashboard = () => {
  const [stats] = useState({
    totalRooms: 0,
    availableRooms: 0,
    occupiedRooms: 0,
    totalRevenue: 0,
  });

  return (
    <div style={styles.container}>
      <h1 style={styles.title}>Dashboard - T·ªïng quan</h1>

      <div style={styles.statsGrid}>
        <div style={{ ...styles.card, backgroundColor: "#4A90E2" }}>
          <h3>T·ªïng s·ªë ph√≤ng</h3>
          <p style={styles.number}>{stats.totalRooms}</p>
        </div>

        <div style={{ ...styles.card, backgroundColor: "#7ED957" }}>
          <h3>Ph√≤ng tr·ªëng</h3>
          <p style={styles.number}>{stats.availableRooms}</p>
        </div>

        <div style={{ ...styles.card, backgroundColor: "#FF6B6B" }}>
          <h3>Ph√≤ng ƒë√£ thu√™</h3>
          <p style={styles.number}>{stats.occupiedRooms}</p>
        </div>

        <div style={{ ...styles.card, backgroundColor: "#FFC542" }}>
          <h3>Doanh thu th√°ng</h3>
          <p style={styles.number}>{stats.totalRevenue} VNƒê</p>
        </div>
      </div>
    </div>
  );
};

const styles = {
  container: {
    width: "100%",
    padding: "2rem 3rem",
    backgroundColor: "#F5F8FF",
  },
  title: {
    fontSize: "2.3rem",
    fontWeight: "700",
    color: "#1F2A40",
  },
  statsGrid: {
    width: "100%",
    display: "grid",
    gridTemplateColumns: "repeat(auto-fit, minmax(260px, 1fr))",
    gap: "1.5rem",
    marginTop: "2rem",
  },
  card: {
    padding: "2rem",
    borderRadius: "12px",
    color: "white",
    boxShadow: "0 4px 12px rgba(0,0,0,0.08)",
  },
  number: {
    fontSize: "2.5rem",
    marginTop: "1rem",
    fontWeight: "bold",
  },
};

export default Dashboard;

```

### frontend\src\pages\Login.jsx
```jsx
import React, { useState } from "react";
import { useNavigate } from "react-router-dom";
import api from "../services/api";

const Login = () => {
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError("");
    setLoading(true);

    try {
      const response = await api.post("/auth/login", { username, password });

      // L∆∞u token v√†o localStorage
      localStorage.setItem("token", response.data.token);
      localStorage.setItem("user", JSON.stringify(response.data.user));

      alert("‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!");
      navigate("/"); // Chuy·ªÉn v·ªÅ trang ch·ªß
    } catch (err) {
      console.error("‚ùå L·ªói ƒëƒÉng nh·∫≠p:", err);
      setError(err.response?.data?.error || "ƒêƒÉng nh·∫≠p th·∫•t b·∫°i");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div style={styles.container}>
      <div style={styles.card}>
        <h1 style={styles.title}>ƒêƒÉng nh·∫≠p</h1>
        <p style={styles.subtitle}>H·ªá th·ªëng qu·∫£n l√Ω kh√°ch s·∫°n</p>

        <form onSubmit={handleSubmit} style={styles.form}>
          <div style={styles.formGroup}>
            <label style={styles.label}>T√™n ƒëƒÉng nh·∫≠p</label>
            <input
              type="text"
              value={username}
              onChange={(e) => setUsername(e.target.value)}
              style={styles.input}
              placeholder="Nh·∫≠p username"
              required
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>M·∫≠t kh·∫©u</label>
            <input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              style={styles.input}
              placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
              required
            />
          </div>

          {error && <p style={styles.error}>{error}</p>}

          <button type="submit" style={styles.button} disabled={loading}>
            {loading ? "ƒêang ƒëƒÉng nh·∫≠p..." : "ƒêƒÉng nh·∫≠p"}
          </button>
        </form>
      </div>
    </div>
  );
};

const styles = {
  container: {
    minHeight: "100vh",
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
    background: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
  },
  card: {
    background: "white",
    padding: "3rem",
    borderRadius: "16px",
    boxShadow: "0 20px 60px rgba(0,0,0,0.3)",
    width: "100%",
    maxWidth: "420px",
  },
  title: {
    fontSize: "2rem",
    fontWeight: 700,
    textAlign: "center",
    color: "#1F2A40",
    marginBottom: "0.5rem",
  },
  subtitle: {
    textAlign: "center",
    color: "#6B7280",
    marginBottom: "2rem",
  },
  form: {
    display: "flex",
    flexDirection: "column",
    gap: "1.5rem",
  },
  formGroup: {
    display: "flex",
    flexDirection: "column",
    gap: "0.5rem",
  },
  label: {
    fontWeight: 600,
    color: "#374151",
  },
  input: {
    padding: "0.75rem",
    borderRadius: "8px",
    border: "1px solid #D1D5DB",
    fontSize: "1rem",
  },
  button: {
    padding: "0.75rem",
    background: "#3A7DFF",
    color: "white",
    border: "none",
    borderRadius: "8px",
    fontSize: "1rem",
    fontWeight: 600,
    cursor: "pointer",
    marginTop: "1rem",
  },
  error: {
    color: "#EF4444",
    fontSize: "0.875rem",
    textAlign: "center",
  },
};

export default Login;

```

### frontend\src\pages\RoomManagement.jsx
```jsx
import React, { useState, useEffect } from "react";
import api from "../services/api";

const emptyForm = {
  maPhong: "",
  tenPhong: "",
  loaiPhong: "",
  tinhTrang: "Tr·ªëng",
  ghiChu: "",
};

const generateRoomCode = (tenPhong) => {
  if (!/ph√≤ng/i.test(tenPhong)) {
    return null;
  }
  const numbers = tenPhong.match(/\d+/g);
  if (!numbers) return null;
  return "P" + numbers.join("");
};

// ‚ùå X√ìA D√íNG N√ÄY - hardcode
// const ROOM_TYPES = ["A", "B", "C"];

const ROOM_STATUS = ["Tr·ªëng", "ƒê√£ thu√™", "ƒêang d·ªçn"];

const RoomManagement = () => {
  const [rooms, setRooms] = useState([]);
  const [roomTypes, setRoomTypes] = useState([]); // ‚úÖ TH√äM STATE M·ªöI
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [mode, setMode] = useState("add");
  const [form, setForm] = useState(emptyForm);
  const [editingId, setEditingId] = useState(null);
  const [errors, setErrors] = useState({});
  const [loading, setLoading] = useState(false);

  // ‚úÖ Load c·∫£ ph√≤ng V√Ä lo·∫°i ph√≤ng
  useEffect(() => {
    fetchRooms();
    fetchRoomTypes(); // ‚Üê TH√äM D√íNG N√ÄY
  }, []);

  const fetchRooms = async () => {
    try {
      setLoading(true);
      const response = await api.get("/phong");
      setRooms(response.data);
    } catch (error) {
      console.error("‚ùå L·ªói khi t·∫£i danh s√°ch ph√≤ng:", error);
      alert("Kh√¥ng th·ªÉ t·∫£i danh s√°ch ph√≤ng");
    } finally {
      setLoading(false);
    }
  };

  // ‚úÖ TH√äM H√ÄM M·ªöI - Load lo·∫°i ph√≤ng t·ª´ API
  const fetchRoomTypes = async () => {
    try {
      const response = await api.get("/loaiphong");
      setRoomTypes(response.data); // [{MaLoaiPhong: "A", TenLoaiPhong: "Lo·∫°i A", DonGia: 150000}, ...]
    } catch (error) {
      console.error("‚ùå L·ªói khi t·∫£i lo·∫°i ph√≤ng:", error);
    }
  };

  // ... (c√°c h√†m kh√°c gi·ªØ nguy√™n)

  const openAddModal = () => {
    setMode("add");
    setForm(emptyForm);
    setErrors({});
    setIsModalOpen(true);
  };

  const openEditModal = (room) => {
    setMode("edit");
    setForm({
      maPhong: room.MaPhong,
      tenPhong: room.TenPhong,
      loaiPhong: room.MaLoaiPhong,
      tinhTrang: room.TinhTrang,
      ghiChu: room.GhiChu || "",
    });
    setEditingId(room.MaPhong);
    setErrors({});
    setIsModalOpen(true);
  };

  const closeModal = () => setIsModalOpen(false);

  const handleChange = (e) =>
    setForm((prev) => ({ ...prev, [e.target.name]: e.target.value }));

  const validate = () => {
    const errs = {};
    if (!form.tenPhong.trim()) errs.tenPhong = "T√™n ph√≤ng kh√¥ng ƒë∆∞·ª£c tr·ªëng";
    if (!form.loaiPhong) errs.loaiPhong = "Ch·ªçn lo·∫°i ph√≤ng";
    setErrors(errs);
    return Object.keys(errs).length === 0;
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!validate()) return;

    setLoading(true);
    const generatedCode = generateRoomCode(form.tenPhong);

    if (!generatedCode) {
      alert("T√™n ph√≤ng ph·∫£i c√≥ ch·ªØ 'Ph√≤ng' v√† s·ªë. VD: Ph√≤ng 101");
      setLoading(false);
      return;
    }
    try {
      const payload = {
        MaPhong: generatedCode,
        TenPhong: form.tenPhong,
        MaLoaiPhong: form.loaiPhong,
        TinhTrang: form.tinhTrang,
        GhiChu: form.ghiChu,
      };

      if (mode === "add") {
        await api.post("/phong", payload);
        alert("‚úÖ Th√™m ph√≤ng th√†nh c√¥ng!");
      } else {
        await api.put(`/phong/${editingId}`, payload);
        alert("‚úÖ C·∫≠p nh·∫≠t ph√≤ng th√†nh c√¥ng!");
      }

      fetchRooms();
      setIsModalOpen(false);
    } catch (error) {
      console.error("‚ùå L·ªói khi l∆∞u ph√≤ng:", error);
      const msg =
        error.response?.data?.message ||
        "Kh√¥ng th·ªÉ l∆∞u ph√≤ng. Vui l√≤ng th·ª≠ l·∫°i.";
      alert("‚ùå " + msg);
    } finally {
      setLoading(false);
    }
  };

  const handleDelete = async (id) => {
    if (!window.confirm("B·∫°n c√≥ ch·∫Øc mu·ªën xo√° ph√≤ng n√†y?")) return;

    try {
      await api.delete(`/phong/${id}`);
      alert("‚úÖ X√≥a ph√≤ng th√†nh c√¥ng!");
      fetchRooms();
    } catch (error) {
      console.error("‚ùå L·ªói khi x√≥a ph√≤ng:", error);
      alert("Kh√¥ng th·ªÉ x√≥a ph√≤ng: " + (error.response?.data?.error || ""));
    }
  };

  return (
    <div style={styles.wrapper}>
      <div style={styles.headerRow}>
        <div>
          <h1 style={styles.title}>Danh m·ª•c ph√≤ng</h1>
          <p style={styles.subtitle}>
            Qu·∫£n l√Ω th√¥ng tin ph√≤ng, lo·∫°i ph√≤ng v√† t√¨nh tr·∫°ng ph√≤ng.
          </p>
        </div>
        <button style={styles.addButton} onClick={openAddModal}>
          + Th√™m ph√≤ng
        </button>
      </div>

      {loading && <p style={{ textAlign: "center" }}>‚è≥ ƒêang t·∫£i...</p>}

      <div style={styles.tableCard}>
        <table style={styles.table}>
          <thead>
            <tr>
              <th style={styles.th}>M√£ ph√≤ng</th>
              <th style={styles.th}>T√™n ph√≤ng</th>
              <th style={styles.th}>Lo·∫°i</th>
              <th style={styles.th}>ƒê∆°n gi√°</th>
              <th style={{ ...styles.th, textAlign: "center" }}>T√¨nh tr·∫°ng</th>
              <th style={styles.th}>Ghi ch√∫</th>
              <th style={{ ...styles.th, textAlign: "center" }}>H√†nh ƒë·ªông</th>
            </tr>
          </thead>

          <tbody>
            {rooms.map((room) => (
              <tr key={room.MaPhong} style={styles.tr}>
                <td style={styles.td}>{room.MaPhong}</td>
                <td style={styles.td}>{room.TenPhong}</td>

                <td style={styles.td}>
                  <span
                    style={loaiPhongBadgeStyle(
                      room.TenLoaiPhong || room.MaLoaiPhong
                    )}
                  >
                    {room.TenLoaiPhong || room.MaLoaiPhong}
                  </span>
                </td>

                <td style={styles.td}>
                  {room.DonGia
                    ? Number(room.DonGia).toLocaleString("vi-VN", {
                        minimumFractionDigits: 0,
                      }) + " VND"
                    : "-"}
                </td>

                <td style={{ ...styles.td, textAlign: "center" }}>
                  <span style={statusBadgeStyle(room.TinhTrang)}>
                    {room.TinhTrang}
                  </span>
                </td>

                <td style={styles.td}>{room.GhiChu}</td>

                <td style={{ ...styles.td, textAlign: "center" }}>
                  <div style={styles.actionRow}>
                    <button
                      style={styles.editButton}
                      onClick={() => openEditModal(room)}
                    >
                      S·ª≠a
                    </button>
                    <button
                      style={styles.deleteButton}
                      onClick={() => handleDelete(room.MaPhong)}
                    >
                      Xo√°
                    </button>
                  </div>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* MODAL */}
      {isModalOpen && (
        <div style={styles.modalOverlay} onClick={closeModal}>
          <div style={styles.modal} onClick={(e) => e.stopPropagation()}>
            <h2 style={styles.modalTitle}>
              {mode === "add" ? "Th√™m ph√≤ng" : "S·ª≠a ph√≤ng"}
            </h2>

            <div style={styles.form}>
              <div style={styles.formRow}>
                <div style={styles.formGroup}>
                  <label>T√™n ph√≤ng</label>
                  <input
                    name="tenPhong"
                    value={form.tenPhong}
                    onChange={handleChange}
                    style={styles.input}
                  />
                  <p
                    style={{
                      fontSize: "0.75rem",
                      color: "#6B7280",
                      marginTop: "0.25rem",
                    }}
                  >
                    VD: Nh·∫≠p "Ph√≤ng 101" ‚Üí M√£ ph√≤ng s·∫Ω t·ª± t·∫°o l√† P101
                  </p>
                  {errors.tenPhong && (
                    <span style={styles.errorText}>{errors.tenPhong}</span>
                  )}
                </div>
              </div>

              <div style={styles.formRow}>
                <div style={styles.formGroup}>
                  <label>Lo·∫°i ph√≤ng</label>
                  <select
                    name="loaiPhong"
                    value={form.loaiPhong}
                    onChange={handleChange}
                    style={styles.input}
                  >
                    <option value="">-- Ch·ªçn lo·∫°i ph√≤ng --</option>
                    {/* ‚úÖ MAP T·ª™ API THAY V√å HARDCODE */}
                    {roomTypes.map((type) => (
                      <option key={type.MaLoaiPhong} value={type.MaLoaiPhong}>
                        {type.TenLoaiPhong} -{" "}
                        {Number(type.DonGia).toLocaleString("vi-VN")} VND
                      </option>
                    ))}
                  </select>
                  {errors.loaiPhong && (
                    <span style={styles.errorText}>{errors.loaiPhong}</span>
                  )}
                </div>

                <div style={styles.formGroup}>
                  <label>T√¨nh tr·∫°ng</label>
                  <select
                    name="tinhTrang"
                    value={form.tinhTrang}
                    onChange={handleChange}
                    style={styles.input}
                  >
                    {ROOM_STATUS.map((st) => (
                      <option key={st}>{st}</option>
                    ))}
                  </select>
                </div>
              </div>

              <div style={styles.formRow}>
                <div style={styles.formGroup}>
                  <label>Ghi ch√∫</label>
                  <input
                    name="ghiChu"
                    value={form.ghiChu}
                    onChange={handleChange}
                    style={styles.input}
                  />
                </div>
              </div>

              <div style={styles.modalActions}>
                <button
                  type="button"
                  onClick={closeModal}
                  style={styles.cancelButton}
                  disabled={loading}
                >
                  H·ªßy
                </button>
                <button
                  type="button"
                  onClick={handleSubmit}
                  style={styles.saveButton}
                  disabled={loading}
                >
                  {loading
                    ? "‚è≥ ƒêang l∆∞u..."
                    : mode === "add"
                    ? "L∆∞u"
                    : "C·∫≠p nh·∫≠t"}
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

// ===== STYLES ===== (gi·ªØ nguy√™n)
const styles = {
  wrapper: {
    width: "100%",
    maxWidth: "1400px",
    margin: "0 auto",
    padding: "2rem 2rem 3rem",
  },
  headerRow: {
    display: "flex",
    justifyContent: "space-between",
    alignItems: "center",
    marginBottom: "1.5rem",
  },
  title: {
    fontSize: "2rem",
    fontWeight: 700,
    color: "#1F2A40",
  },
  subtitle: {
    marginTop: "0.3rem",
    color: "#6B7280",
  },
  addButton: {
    padding: "0.6rem 1.4rem",
    backgroundColor: "#3A7DFF",
    color: "white",
    borderRadius: "8px",
    border: "none",
    cursor: "pointer",
    fontWeight: 600,
    boxShadow: "0 5px 14px rgba(58, 125, 255, 0.35)",
  },
  tableCard: {
    background: "white",
    borderRadius: "16px",
    boxShadow: "0 8px 20px rgba(15, 23, 42, 0.08)",
    padding: "1.5rem",
    overflowX: "auto",
  },
  table: {
    width: "100%",
    borderCollapse: "collapse",
    fontSize: "0.95rem",
  },
  th: {
    padding: "12px 16px",
    backgroundColor: "#F9FAFB",
    borderBottom: "2px solid #E5E7EB",
    fontWeight: 600,
    color: "#374151",
    textAlign: "left",
  },
  tr: {
    borderBottom: "1px solid #E5E7EB",
  },
  td: {
    padding: "12px 16px",
    verticalAlign: "middle",
  },
  actionRow: {
    display: "flex",
    justifyContent: "center",
    gap: "0.5rem",
  },
  editButton: {
    background: "#3A7DFF",
    color: "white",
    padding: "6px 14px",
    borderRadius: "6px",
    border: "none",
    cursor: "pointer",
    fontSize: "0.875rem",
    fontWeight: 500,
  },
  deleteButton: {
    background: "#EF4444",
    color: "white",
    padding: "6px 14px",
    borderRadius: "6px",
    border: "none",
    cursor: "pointer",
    fontSize: "0.875rem",
    fontWeight: 500,
  },
  modalOverlay: {
    position: "fixed",
    inset: 0,
    backgroundColor: "rgba(0,0,0,0.35)",
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
    zIndex: 999,
  },
  modal: {
    width: "100%",
    maxWidth: "680px",
    background: "white",
    padding: "2rem",
    borderRadius: "16px",
    boxShadow: "0 20px 40px rgba(0,0,0,0.2)",
  },
  modalTitle: {
    fontSize: "1.4rem",
    marginBottom: "1rem",
    fontWeight: 700,
    color: "#1F2A40",
  },
  form: {
    display: "flex",
    flexDirection: "column",
    gap: "1rem",
  },
  formRow: {
    display: "flex",
    gap: "1rem",
  },
  formGroup: {
    flex: 1,
    display: "flex",
    flexDirection: "column",
    gap: "0.3rem",
  },
  input: {
    padding: "0.55rem 0.75rem",
    borderRadius: "8px",
    border: "1px solid #D1D5DB",
    fontSize: "0.95rem",
  },
  errorText: {
    color: "#EF4444",
    fontSize: "0.8rem",
    marginTop: "0.2rem",
  },
  modalActions: {
    display: "flex",
    justifyContent: "flex-end",
    gap: "0.8rem",
    marginTop: "1rem",
  },
  cancelButton: {
    padding: "0.5rem 1.2rem",
    borderRadius: "8px",
    border: "1px solid #D1D5DB",
    background: "white",
    cursor: "pointer",
  },
  saveButton: {
    padding: "0.5rem 1.4rem",
    borderRadius: "8px",
    border: "none",
    background: "#3A7DFF",
    color: "white",
    cursor: "pointer",
    fontWeight: 600,
  },
};

// Badge cho lo·∫°i ph√≤ng - Dynamic colors
const loaiPhongBadgeStyle = (loai) => {
  const colors = {
    A: { bg: "#DBEAFE", color: "#1D4ED8" },
    "Lo·∫°i A": { bg: "#DBEAFE", color: "#1D4ED8" },
    B: { bg: "#FEF3C7", color: "#D97706" },
    "Lo·∫°i B": { bg: "#FEF3C7", color: "#D97706" },
    C: { bg: "#FEE2E2", color: "#DC2626" },
    "Lo·∫°i C": { bg: "#FEE2E2", color: "#DC2626" },
    D: { bg: "#E9D5FF", color: "#7C3AED" }, // Th√™m m√†u cho D
    "Lo·∫°i D": { bg: "#E9D5FF", color: "#7C3AED" },
  };

  const style = colors[loai] || { bg: "#E0EAFF", color: "#1E40AF" };

  return {
    display: "inline-block",
    padding: "4px 12px",
    borderRadius: "8px",
    fontWeight: 600,
    fontSize: "0.85rem",
    backgroundColor: style.bg,
    color: style.color,
    minWidth: "36px",
    textAlign: "center",
  };
};

const statusBadgeStyle = (status) => {
  let bg = "#E5E7EB";
  let color = "#374151";

  if (status === "Tr·ªëng") {
    bg = "#D1FAE5";
    color = "#059669";
  } else if (status === "ƒê√£ thu√™") {
    bg = "#FEE2E2";
    color = "#DC2626";
  } else if (status === "ƒêang d·ªçn") {
    bg = "#FEF3C7";
    color = "#D97706";
  }

  return {
    display: "inline-block",
    padding: "4px 12px",
    borderRadius: "10px",
    fontWeight: 600,
    fontSize: "0.85rem",
    backgroundColor: bg,
    color,
    minWidth: "80px",
  };
};

export default RoomManagement;

```

### frontend\src\services\api.js
```js
import axios from "axios";

const api = axios.create({
  baseURL: "http://localhost:9999/api",
  headers: {
    "Content-Type": "application/json",
  },
});

export default api;

```
